{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ASIR - PR\u00c1CTICAS IAW - AITOR RODR\u00cdGUEZ YEBRA","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"about/","title":"IAW - Pr\u00e1ctica MkDocs","text":""},{"location":"practica1/","title":"IAW - Pr\u00e1ctica 1.1","text":""},{"location":"practica1/#instalacion-de-la-pila-lamp-en-una-instancia-ec2-de-aws-con-ubuntu-server","title":"Instalaci\u00f3n de la pila LAMP en una instancia EC2 de AWS con Ubuntu Server","text":""},{"location":"practica1/#preparacion-de-la-estructura-de-directorios","title":"Preparaci\u00f3n de la estructura de directorios","text":"<p>Clonamos el repositorio que hemos creado para la pr\u00e1ctica previamente en GitHub en nuestra carpeta personal</p> <pre><code>mkdir ~/repositorios/\n\ncd ~/repositorios/\n\ngit clone https://github.com/arodyeb/IAW-Practica1.1.git\n</code></pre> <p>Creamos las carpetas conf, htaccess, php y scripts en el directorio ra\u00edz del repositorio, donde guardaremos los archivos necesarios para configurar la instalaci\u00f3n de la pila LAMP</p> <pre><code>mkdir conf htaccess php scripts\n</code></pre>"},{"location":"practica1/#definicion-de-variables-en-archivo-env","title":"Definici\u00f3n de variables en archivo .env","text":"<p>Es necesario crear un archivo .env en el directorio de scripts con valores para una serie de variables que ser\u00e1n usadas posteriormente por los scripts de instalaci\u00f3n. Para evitar compartir el valor de dichas variables y que sea personalizable, en su lugar se comparte un archivo como plantilla que se ha de personalizar y renombrar.  </p>"},{"location":"practica1/#configuracion-de-install_lampsh","title":"Configuraci\u00f3n de \"install_lamp.sh\"","text":"<p>En la carpeta de scripts, creamos el archivo \"install_lamp.sh\"</p> <pre><code>cd scripts/\nsudo nano install_lamp.sh\n</code></pre> <p>Configuramos el script para que se detenga si ocurre alg\u00fan error y adem\u00e1s muestre los comandos por pantalla</p> <pre><code>#!/bin/bash\n\nset -ex\n</code></pre> <p>Actualizamos repositorios</p> <pre><code>apt update\n\napt upgrade -y\n</code></pre> <p>Instalamos Apache, habilitamos el m\u00f3dulo rewrite y copiamos el archivo de configuraci\u00f3n personalizado</p> <pre><code>apt install apache2 -y\n\na2enmod rewrite\n\ncp ../conf/000-default.conf /etc/apache2/sites-available\n</code></pre> <p>Instalamos PHP, el m\u00f3dulo de ejecuci\u00f3n de scripts PHP de Apache y la extensi\u00f3n de conexi\u00f3n entre PHP y MySQL</p> <pre><code>apt install php libapache2-mod-php php-mysql -y\n</code></pre> <p>Reiniciamos Apache para llevar a cabo los cambios y copiamos el archivo index</p> <pre><code>systemctl restart apache2\n\ncp ../php/index.php /var/www/html/\n</code></pre> <p>Instalamos MySQL y damos permisos sobre los archivos del sitio web al usuario y grupo de Apache  </p> <pre><code>apt install mysql-server -y\n\nchown -R www-data:www-data /var/www/html/*\n</code></pre> <p>Instalamos MySQL y damos permisos sobre los archivos del sitio web al usuario y grupo de Apache</p> <pre><code>apt install mysql-server -y\n\nchown -R www-data:www-data /var/www/html/*\n</code></pre> <p>El contenido del script debe ser tal que as\u00ed:  </p> <pre><code>#!/bin/bash\n\n#Configuramos el script para que se detenga si ocurre alg\u00fan error y adem\u00e1s muestre los comandos por pantalla\n\nset -ex\n\n#Actualizamos repositorios\n\napt update\n\napt upgrade -y\n\n#Instalamos Apache, habilitamos el m\u00f3dulo rewrite y copiamos el archivo de configuraci\u00f3n personalizado\n\napt install apache2 -y\n\na2enmod rewrite\n\ncp ../conf/000-default.conf /etc/apache2/sites-available\n\n#Instalamos PHP, el m\u00f3dulo de ejecuci\u00f3n de scripts PHP de Apache y la extensi\u00f3n de conexi\u00f3n entre PHP y MySQL\n\napt install php libapache2-mod-php php-mysql -y\n\n#Reiniciamos Apache para llevar a cabo los cambios y copiamos el archivo index\n\nsystemctl restart apache2\n\ncp ../php/index.php /var/www/html/\n\n#Instalamos MySQL y damos permisos sobre los archivos del sitio web al usuario y grupo de Apache  \n\napt install mysql-server -y\n\nchown -R www-data:www-data /var/www/html/*\n\n#Instalamos MySQL y damos permisos sobre los archivos del sitio web al usuario y grupo de Apache\n\napt install mysql-server -y\n\nchown -R www-data:www-data /var/www/html/*\n</code></pre> <p>Al guardar el script de instalaci\u00f3n de la pila LAMP, le damos permisos de ejecuci\u00f3n:</p> <pre><code>sudo chmod +x install_lamp.sh\n</code></pre> <p>Creamos un archivo .env:</p> <pre><code>sudo nano .env\n</code></pre> <p>En este archivo se deben personalizar una serie de variables a las que luego se har\u00e1 referencia en otro script:</p> <pre><code>PHPMYADMIN_APP_PASSWORD=tu_password_phpmyadmin\nDB_NAME=nombre_base\nDB_USER=usuario_base\nDB_PASSWORD=password_base\nSTATS_USERNAME=usuario_stats\nSTATS_PASSWORD=password_stats\nhome=/home/tu_usuario\n</code></pre> <p>Creamos el script \"install_tools.sh\":</p> <pre><code>sudo nano install_tools.sh\n</code></pre> <p>Configuramos el script:</p> <pre><code>#!/bin/bash\n\n# Configuramos el script para que se detenga si ocurre alg\u00fan error y adem\u00e1s muestre los comandos por pantalla\n\nset -ex\n\n# Importamos el archivo .env\n\nsource .env\n\n# Configuramos las respuestas de la instalaci\u00f3n de phpmyadmin\n\necho \"phpmyadmin phpmyadmin/reconfigure-webserver multiselect apache2\" | debconf-set-selections\n\necho \"phpmyadmin phpmyadmin/dbconfig-install boolean true\" | debconf-set-selections\n\necho \"phpmyadmin phpmyadmin/mysql/app-pass password $PHPMYADMIN_APP_PASSWORD\" | debconf-set-selections\n\necho \"phpmyadmin phpmyadmin/app-password-confirm password $PHPMYADMIN_APP_PASSWORD\" | debconf-set-selections\n\n# Actualizamos repositorios\n\napt update\n\n# Instalamos phpmyadmin\n\nsudo apt install phpmyadmin php-mbstring php-zip php-gd php-json php-curl -y\n\n# Creamos una carpeta para AdMiner y lo instalamos\n\nmkdir -p /var/www/html/adminer\n\nwget https://github.com/vrana/adminer/releases/download/v5.4.1/adminer-5.4.1-mysql.php -P /var/www/html/adminer/\n\nmv /var/www/html/adminer/adminer-5.4.1-mysql.php /var/www/html/adminer/index.php\n\n\n# Creamos una base de datos para comprobar que funciona\n\nmysql -u root -e \"DROP  DATABASE IF EXISTS $DB_NAME\"\n\nmysql -u root -e \"CREATE DATABASE $DB_NAME\"\n\n# Creamos un usuario\n\nmysql -u root -e \"DROP USER IF EXISTS $DB_USER@'%';\"\n\nmysql -u root -e \"CREATE USER '$DB_USER'@'%' IDENTIFIED BY '$DB_PASSWORD';\"\n\n# Damos permisos al usuario sobre la base de datos\n\nmysql -u root -e \"GRANT ALL PRIVILEGES ON $DB_NAME.* TO $DB_USER@'%';\"\n\n# Instalamos GoAccess\n\nsudo apt install goaccess -y\n\n# Creamos la carpeta stats en el directorio de Apache\n\nmkdir -p /var/www/html/stats\n\n# Creamos la carpeta htaccess en el home del usuario\n\nmkdir -p $home/htaccess\n\ngoaccess /var/log/apache2/access.log -o /var/www/html/stats/index.html --log-format=COMBINED --real-time-html --daemonize\n\ncp ../conf/000-default-stats.conf /etc/apache2/sites-available/000-default.conf\n\nsudo htpasswd -bc /etc/apache2/.htpasswd $STATS_USERNAME $STATS_PASSWORD\n\n# Copiamos el archivo htaccess\n\ncp ../htaccess/.htaccess /var/www/html/stats\n\n# Y reiniciamos Apache\n\nsystemctl restart apache2\n</code></pre> <p>Al terminar de configurar el script, guardamos los cambios y le damos permisos de ejecuci\u00f3n:</p> <pre><code>sudo chmod +x install_tools.sh\n</code></pre> <p>Una vez configurados los scripts de instalaci\u00f3n, ejecutar primero el script de la pila Lamp</p> <pre><code>sudo ./install_lamp.sh\n</code></pre> <p> </p> <p>Y una vez comprobado que el script se ha ejecutado correctamente, ejecutamos el script de herramientas y comprobamos que tambi\u00e9n se haga sin errores</p> <pre><code>sudo ./install_tools.sh\n</code></pre> <p> </p>"}]}